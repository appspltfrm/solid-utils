{"version":3,"file":"renderToDom.js","sources":["../../src/lib/web/renderToDom.ts"],"sourcesContent":["import {Component, createComponent, createEffect, createRoot, createSignal, lazy} from \"solid-js\";\nimport {assign, insert} from \"solid-js/web\";\n\nconst disposeProp = Symbol(\"renderToDom:dispose\");\n\ntype SolidComponent = Component<any> | ReturnType<typeof lazy>;\ntype SolidComponentWrapper = {component: SolidComponent | string};\nexport type RenderedElement<T extends Element = Element> = T & {[disposeProp]?: VoidFunction};\n\nexport async function renderToDom<T extends Element = Element>(\n    parentNode: Node,\n    rawComponent: SolidComponent | SolidComponentWrapper | string,\n    props?: any): Promise<RenderedElement<T>> {\n\n    const component = (typeof rawComponent === \"object\" && rawComponent.component) || rawComponent;\n\n    let view: HTMLElement;\n\n    if (typeof component === \"string\") {\n        view = document.createElement(component);\n        assign(view, props, false, true);\n        parentNode.appendChild(view);\n\n    } else {\n        view = await new Promise<HTMLElement>((resolve) => {\n            createRoot((dispose) => {\n                insert(parentNode, () => {\n\n                    const [element, setElement] = createSignal<HTMLElement>();\n\n                    createEffect(() => {\n                        if (element()) {\n                            (element() as RenderedElement)[disposeProp] = () => {\n                                dispose();\n                                delete (element() as RenderedElement)[disposeProp];\n                            }\n                            resolve(element() as HTMLElement);\n                        }\n                    })\n\n                    return createComponent(component as SolidComponent, {...props, ref: setElement});\n                })\n            })\n        })\n    }\n\n    return view as unknown as T;\n}\n\nexport async function disposeRenderedElement(element: RenderedElement) {\n    element[disposeProp]?.();\n}\n"],"names":["disposeProp","renderToDom","parentNode","rawComponent","props","component","view","assign","resolve","createRoot","dispose","insert","element","setElement","createSignal","createEffect","createComponent","disposeRenderedElement","_a"],"mappings":";;AAGA,MAAMA,IAAc,OAAO,qBAAqB;AAM1B,eAAAC,EAClBC,GACAC,GACAC,GAA0C;AAE1C,QAAMC,IAAa,OAAOF,KAAiB,YAAYA,EAAa,aAAcA;AAE9E,MAAAG;AAEA,SAAA,OAAOD,KAAc,YACdC,IAAA,SAAS,cAAcD,CAAS,GAChCE,EAAAD,GAAMF,GAAO,IAAO,EAAI,GAC/BF,EAAW,YAAYI,CAAI,KAG3BA,IAAO,MAAM,IAAI,QAAqB,CAACE,MAAY;AAC/C,IAAAC,EAAW,CAACC,MAAY;AACpB,MAAAC,EAAOT,GAAY,MAAM;AAErB,cAAM,CAACU,GAASC,CAAU,IAAIC,EAA0B;AAExD,eAAAC,EAAa,MAAM;AACf,UAAIH,QACCA,EAAQ,EAAsBZ,CAAW,IAAI,MAAM;AACxC,YAAAU,EAAA,GACA,OAAAE,IAA8BZ,CAAW;AAAA,UACrD,GACAQ,EAAQI,GAAwB;AAAA,QACpC,CACH,GAEMI,EAAgBX,GAA6B,EAAC,GAAGD,GAAO,KAAKS,GAAW;AAAA,MAAA,CAClF;AAAA,IAAA,CACJ;AAAA,EAAA,CACJ,GAGEP;AACX;AAEA,eAAsBW,EAAuBL,GAA0B;;AACnE,GAAAM,IAAAN,EAAQZ,OAAR,QAAAkB,EAAA,KAAAN;AACJ;"}