{"version":3,"file":"elementComponent.js","sources":["../../src/lib/elements/elementComponent.tsx"],"sourcesContent":["import type {AssignableType, Type} from \"@co.mmons/js-utils/core\";\nimport {children, Component, ParentProps, sharedConfig, splitProps} from \"solid-js\";\nimport {JSX} from \"solid-js/h/jsx-runtime\";\nimport {getNextElement, spread} from \"solid-js/web\";\nimport {camelPropsToDashedAttrs} from \"./camelPropsToDashedAttrs\";\nimport {ElementAttrAttributes} from \"./ElementAttrAttributes\";\nimport {ElementEventsProps} from \"./ElementEventsProps\";\nimport {ElementProps} from \"./ElementProps\";\nimport {registerElement} from \"./registerElement\";\nimport {SolidElement} from \"./SolidElement\";\n\nexport type ElementComponent<TagName extends string, ElementType extends SolidElement, ComponentProps = any> = Component<ComponentProps & JSX.HTMLAttributes<ElementType> & ElementAttrAttributes> & {\n    tagName: TagName;\n    configure<Props = ComponentProps, Events extends {[P in keyof Events]: Event} = any>(): ElementComponent<TagName, ElementType, Props & ElementEventsProps<ElementType, Events>>;\n    register(): void\n}\n\nexport function elementComponent<TagName extends string, ElementType extends SolidElement>(tagName: TagName, elementType: AssignableType<ElementType>): ElementComponent<TagName, ElementType, ElementProps<ElementType>> {\n\n    const extendedType: Type<ElementType> & {reactive: {[propName: string]: boolean}} = elementType as any;\n\n    const template: Component<any> = (rawProps: ParentProps<any>) => {\n\n        if (!customElements.get(tagName)) {\n            registerElement(tagName, elementType);\n        }\n\n        const rawChildren = children(() => rawProps.children);\n        const [, props, others] = splitProps(rawProps, [\"children\"], Object.keys(extendedType.reactive ?? {}));\n\n        const el = sharedConfig.context ? getNextElement() : document.createElement(tagName);\n        const noShadow = (el as any)[\"renderRoot\"] === el;\n\n        spread(el, {\n            ...camelPropsToDashedAttrs(props),\n            ...others,\n            children: (!noShadow && rawChildren) ?? [],\n            \"slotted-children\": (noShadow && rawChildren.toArray()) ?? []\n        }, false, noShadow);\n\n        return el;\n    }\n\n    const component = template as any as ElementComponent<TagName, ElementType, ElementProps<ElementType>>;\n    component[\"tagName\"] = tagName;\n    component[\"configure\"] = () => component as any;\n    component[\"register\"] = () => registerElement(tagName, elementType);\n\n    return component as any;\n}\n"],"names":["elementComponent","tagName","elementType","extendedType","component","rawProps","customElements","get","registerElement","rawChildren","children","props","others","splitProps","Object","keys","reactive","el","sharedConfig","context","getNextElement","document","createElement","noShadow","spread","camelPropsToDashedAttrs","toArray"],"mappings":";;;;AAiBO,SAASA,EAA2EC,GAAkBC,GAA6G;AAEtN,QAAMC,IAA8ED,GAwB9EE,IAtB4BC,CAAAA,MAA+B;AAE7D,IAAKC,eAAeC,IAAIN,CAAO,KAC3BO,EAAgBP,GAASC,CAAW;AAGxC,UAAMO,IAAcC,EAAS,MAAML,EAASK,QAAQ,GAC9C,CAAGC,EAAAA,GAAOC,CAAM,IAAIC,EAAWR,GAAU,CAAC,UAAU,GAAGS,OAAOC,KAAKZ,EAAaa,YAAY,CAAA,CAAE,CAAC,GAE/FC,IAAKC,EAAaC,UAAUC,EAAgB,IAAGC,SAASC,cAAcrB,CAAO,GAC7EsB,IAAYN,EAAW,eAAkBA;AAE/CO,WAAAA,EAAOP,GAAI;AAAA,MACP,GAAGQ,EAAwBd,CAAK;AAAA,MAChC,GAAGC;AAAAA,MACHF,WAAW,CAACa,KAAYd,MAAgB,CAAE;AAAA,MAC1C,qBAAqBc,KAAYd,EAAYiB,QAAS,MAAK,CAAA;AAAA,IAC/D,GAAG,IAAOH,CAAQ,GAEXN;AAAAA;AAIXb,SAAAA,EAAU,UAAaH,GACvBG,EAAU,YAAe,MAAMA,GAC/BA,EAAU,WAAc,MAAMI,EAAgBP,GAASC,CAAW,GAE3DE;AACX;"}